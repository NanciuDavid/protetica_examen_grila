<!DOCTYPE html>
<html lang="ro">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quiz Protetică Dentară</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg,#667eea,#764ba2);
  min-height:100vh;
  padding:20px;
}

.container {
  max-width:900px;
  margin:auto;
  background:#fff;
  border-radius:16px;
  overflow:hidden;
}

.header {
  background:#667eea;
  color:white;
  padding:30px;
  text-align:center;
}

.progress-container {
  height:8px;
  background:rgba(255,255,255,.3);
  border-radius:10px;
  margin-top:10px;
}

.progress-bar {
  height:100%;
  width:0%;
  background:#4CAF50;
}

.content {
  padding:30px;
}

.option {
  border:2px solid #ddd;
  border-radius:8px;
  padding:12px;
  margin-bottom:10px;
  cursor:pointer;
}

.option.correct { background:#e8f5e9; border-color:#4CAF50; }
.option.incorrect { background:#ffebee; border-color:#f44336; }
.option.missed { background:#fff3e0; border-color:#ff9800; }

.buttons {
  margin-top:20px;
  display:flex;
  gap:10px;
}

.btn {
  flex:1;
  padding:12px;
  border:none;
  border-radius:8px;
  cursor:pointer;
  font-weight:bold;
}

.btn-primary {
  background:#667eea;
  color:white;
}

.btn-secondary {
  background:#eee;
}

.feedback {
  margin-top:15px;
  padding:15px;
  border-radius:8px;
  display:none;
}

.feedback.show { display:block; }
.feedback.correct { background:#e8f5e9; }
.feedback.incorrect { background:#ffebee; }

.results {
  display:none;
  text-align:center;
}
.results.show { display:block; }
</style>
</head>

<body>

<div class="container">
  <div class="header">
    <h1>Quiz Protetică Dentară</h1>
    <p>Testează-ți cunoștințele</p>

    <div class="progress-container">
      <div class="progress-bar" id="progressBar"></div>
    </div>

    <p id="remainingCounter" style="margin-top:10px;">
      Întrebări rămase: 0
    </p>
  </div>

  <div class="content">

    <!-- START -->
    <div id="startScreen">
      <p><strong>Număr întrebări:</strong> <span id="totalQuestions">0</span></p>
      <p><strong>Timp estimat:</strong> <span id="estimatedTime">0</span></p>
      <br>
      <button class="btn btn-primary" onclick="startQuiz()">Începe Quiz-ul</button>
    </div>

    <!-- QUESTIONS -->
    <div id="questionsContainer"></div>

    <!-- RESULTS -->
    <div id="resultsScreen" class="results">
      <h2>Rezultat final</h2>
      <h1 id="scoreCircle">0%</h1>
      <p>Corecte: <span id="correctAnswers"></span></p>
      <p>Greșite: <span id="incorrectAnswers"></span></p>
      <button class="btn btn-primary" onclick="restartQuiz()">Reîncepe</button>
    </div>

  </div>
</div>

<!-- LOAD QUESTIONS -->
<script src="js/app.js"></script>

<!-- QUIZ LOGIC -->
<script>
document.addEventListener("DOMContentLoaded", () => {

  const quizData = window.QUIZ_QUESTIONS;
  let currentQuestion = 0;
  let score = 0;
  let answered = Array(quizData.length).fill(false);

  document.getElementById("totalQuestions").innerText = quizData.length;
  document.getElementById("estimatedTime").innerText =
    Math.ceil(quizData.length * 1.5) + " min";

  window.startQuiz = () => {
    document.getElementById("startScreen").style.display = "none";
    renderQuestion();
    updateProgress();
  };

  function renderQuestion() {
    const q = quizData[currentQuestion];
    const container = document.getElementById("questionsContainer");

    container.innerHTML = `
      <h3>${currentQuestion + 1}. ${q.stem}</h3>

      ${q.options.map(o => `
        <div class="option" onclick="toggleOption(this)">
          <input type="checkbox" value="${o.key}">
          ${o.key}. ${o.text}
        </div>
      `).join("")}

      <div class="feedback" id="feedback"></div>

      <div class="buttons">
        <button class="btn btn-secondary" onclick="skipQuestion()">Sari peste</button>
        <button class="btn btn-primary" onclick="checkAnswer()">Verifică</button>
      </div>
    `;
  }

  window.toggleOption = el => {
    const cb = el.querySelector("input");
    cb.checked = !cb.checked;
  };

  window.checkAnswer = () => {
    const q = quizData[currentQuestion];
    const selected = [...document.querySelectorAll("input:checked")]
      .map(i => i.value);

    if (!selected.length) {
      alert("Selectează cel puțin un răspuns.");
      return;
    }

    const correct = [...q.answer_keys].sort();
    const user = [...selected].sort();

    const isCorrect =
      correct.length === user.length &&
      correct.every(v => user.includes(v));

    if (isCorrect) score++;
    answered[currentQuestion] = true;

    document.querySelectorAll(".option").forEach(opt => {
      const key = opt.querySelector("input").value;
      if (correct.includes(key)) {
        opt.classList.add(user.includes(key) ? "correct" : "missed");
      } else if (user.includes(key)) {
        opt.classList.add("incorrect");
      }
      opt.style.pointerEvents = "none";
    });

    const fb = document.getElementById("feedback");
    fb.className = "feedback show " + (isCorrect ? "correct" : "incorrect");
    fb.innerHTML = q.rationale;

    document.querySelector(".buttons").innerHTML = `
      <button class="btn btn-primary" onclick="nextQuestion()">
        ${currentQuestion < quizData.length - 1 ? "Următoarea" : "Rezultate"}
      </button>
    `;

    updateProgress();
  };

  window.skipQuestion = () => {
    nextQuestion();
  };

  window.nextQuestion = () => {
    currentQuestion++;
    currentQuestion < quizData.length ? renderQuestion() : showResults();
  };

  function updateProgress() {
    const solved = answered.filter(v => v).length;
    const remaining = quizData.length - solved;

    document.getElementById("progressBar").style.width =
      (solved / quizData.length) * 100 + "%";

    document.getElementById("remainingCounter").innerText =
      "Întrebări rămase: " + remaining;
  }

  function showResults() {
    document.getElementById("questionsContainer").innerHTML = "";
    document.getElementById("resultsScreen").classList.add("show");

    const percent = Math.round((score / quizData.length) * 100);

    document.getElementById("scoreCircle").innerText = percent + "%";
    document.getElementById("correctAnswers").innerText = score;
    document.getElementById("incorrectAnswers").innerText =
      quizData.length - score;
  }

  window.restartQuiz = () => location.reload();

});
</script>

</body>
</html>
